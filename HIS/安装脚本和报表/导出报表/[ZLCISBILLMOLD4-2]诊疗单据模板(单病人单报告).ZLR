[HEAD]
报表编号=ZLCISBILLMOLD4-2
报表名称=诊疗单据模板(单病人单报告)
报表说明=新增诊疗单据基本样式之一，随便删除将导致无法定义其他诊疗单据
导出用户=ZLHIS
导出时间=2005-12-31 15:07:11
[ZLREPORTS]
;
ID=[NextVal];
编号=[编号];
名称=诊疗单据模板(单病人单报告);
说明=新增诊疗单据基本样式之一，随便删除将导致无法定义其他诊疗单据;
密码=Thnp\v- '5;>~vfOxDJ;
W=10318;
H=14513;
纸张=256;
纸向=1;
进纸=1;
打印机=Microsoft Office Document Image Writer;
票据=1;
系统=;
程序ID=;
功能=;
修改时间=Sysdate;
发布时间=;
动态纸张=0;
[ZLRPTFMTS]
;
报表ID=[zlReports_ID.CurrVal];
序号=1;
说明=报告;
图样=0;
[ZLRPTITEMS]
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=标签19;
类型=2;
上级ID=;
序号=0;
参照=任意表1;
性质=13;
内容=受检人员:[体检档案.受检人员];
表头=;
X=6915;
Y=1430;
W=2940;
H=210;
行高=0;
对齐=0;
自调=1;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=标签21;
类型=2;
上级ID=;
序号=0;
参照=任意表1;
性质=23;
内容=检查日期:[体检小结.检查日期];
表头=;
X=6915;
Y=13300;
W=2940;
H=210;
行高=0;
对齐=0;
自调=1;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=任意表1;
类型=4;
上级ID=;
序号=0;
参照=;
性质=0;
内容=体检结果;
表头=;
X=555;
Y=1740;
W=9300;
H=7110;
行高=345;
对齐=0;
自调=0;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=1;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=;
类型=6;
上级ID=[CurrVal-X];
序号=0;
参照=;
性质=;
内容=[体检结果.项目];
表头=1^345^项目;
X=0;
Y=0;
W=3510;
H=0;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=0;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=0;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=;
类型=6;
上级ID=[CurrVal-X];
序号=1;
参照=;
性质=;
内容=[体检结果.内容];
表头=1^345^内容;
X=0;
Y=0;
W=2865;
H=0;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=0;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=0;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=;
类型=6;
上级ID=[CurrVal-X];
序号=3;
参照=;
性质=;
内容=[体检结果.提示];
表头=1^345^提示;
X=0;
Y=0;
W=615;
H=0;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=0;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=0;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=;
类型=6;
上级ID=[CurrVal-X];
序号=2;
参照=;
性质=;
内容=[体检结果.参考];
表头=1^345^参考;
X=0;
Y=0;
W=2250;
H=0;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=0;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=0;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=标签9;
类型=2;
上级ID=;
序号=0;
参照=任意表1;
性质=12;
内容=[检查项目.项目];
表头=;
X=1995;
Y=690;
W=6420;
H=375;
行高=0;
对齐=1;
自调=0;
字体=黑体;
字号=18;
粗体=1;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=标签18;
类型=2;
上级ID=;
序号=0;
参照=任意表1;
性质=11;
内容=体检编号:[体检档案.体检编号];
表头=;
X=555;
Y=1430;
W=2940;
H=210;
行高=0;
对齐=2;
自调=1;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=标签20;
类型=2;
上级ID=;
序号=0;
参照=任意表1;
性质=21;
内容=检查医生:[体检小结.检查医生];
表头=;
X=555;
Y=13300;
W=2940;
H=210;
行高=0;
对齐=0;
自调=1;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=任意表2;
类型=4;
上级ID=;
序号=0;
参照=任意表1;
性质=1;
内容=体检小结;
表头=;
X=555;
Y=8850;
W=9300;
H=4335;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=10.5;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=16777215;
边框=1;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
格式号=1;
名称=;
类型=6;
上级ID=[CurrVal-X];
序号=0;
参照=;
性质=;
内容=;
表头=0^4245^[体检小结.结果];
X=0;
Y=0;
W=9240;
H=0;
行高=255;
对齐=0;
自调=0;
字体=宋体;
字号=0;
粗体=0;
斜体=0;
下线=0;
前景=0;
背景=0;
边框=0;
排序=;
格式=;
汇总=;
分栏=1;
网格=0;
系统=;
[ZLRPTDATAS]
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
名称=检查项目;
字段=项目,200;
对象=USER.病人医嘱发送,USER.病人医嘱记录,USER.诊疗项目目录;
类型=0;
[ZLRPTSQLS]
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=1;
内容=Select I.名称 As 项目;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=2;
内容=  From 诊疗项目目录 I,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=3;
内容=	   (Select Max(诊疗项目id) As 诊疗项目id			   ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=4;
内容=		  From (Select decode(序号, 1, 诊疗项目id) As 诊疗项目id					   ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=5;
内容=				  From (Select Rownum As 序号,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=6;
内容=							   A.诊疗项目id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=7;
内容=						  From 病人医嘱记录 A,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=8;
内容=							   (Select S.医嘱id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=9;
内容=								  From 病人医嘱发送 S;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=10;
内容=								 Where S.No = [0] And S.记录性质 = [1]) S;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=11;
内容=						 Where A.Id = S.医嘱id))) A;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=12;
内容= Where I.Id = A.诊疗项目id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=13;
内容=;
[ZLRPTPARS]
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=0;
名称=NO;
类型=0;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=1;
名称=性质;
类型=1;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
[ZLRPTDATAS]
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
名称=体检档案;
字段=受检人员,200|受检单位,200|受检日期,200|体检编号,131;
对象=USER.病人医嘱发送,USER.病人医嘱记录,USER.体检人员档案,USER.病人信息,USER.体检登记记录,USER.合约单位;
类型=0;
[ZLRPTSQLS]
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=1;
内容=;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=2;
内容=SELECT 	B.姓名 As 受检人员, ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=3;
内容=	D.名称 AS 受检单位,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=4;
内容=	TO_CHAR(C.体检时间,'yyyy-mm-dd') AS 受检日期,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=5;
内容=	B.门诊号 AS 体检编号;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=6;
内容=FROM 	体检人员档案 A,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=7;
内容=	病人信息 B,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=8;
内容=	体检登记记录 C,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=9;
内容=	合约单位 D,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=10;
内容=	;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=11;
内容=	(Select Distinct Y.病人id,Y.挂号单 From 病人医嘱发送 X,病人医嘱记录 Y Where X.医嘱id=Y.ID AND X.No=[0] And X.记录性质=[1]) S;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=12;
内容=;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=13;
内容=WHERE 	A.病人id=B.病人id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=14;
内容=	AND C.ID=A.登记id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=15;
内容=	AND C.合约单位id=D.ID(+);
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=16;
内容=	AND C.体检号=S.挂号单;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=17;
内容=	AND A.病人id=S.病人id;
[ZLRPTPARS]
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=0;
名称=NO;
类型=0;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=1;
名称=性质;
类型=1;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
[ZLRPTDATAS]
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
名称=体检结果;
字段=项目,200|内容,200|参考,200|提示,200|排列序号,139|元素内序号,139;
对象=USER.病人医嘱发送,USER.病人病历所见单,USER.病人病历内容,USER.诊治所见项目,USER.病人病历文本段;
类型=0;
[ZLRPTSQLS]
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=1;
内容=;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=2;
内容=SELECT * FROM (  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=3;
内容=    SELECT  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=4;
内容=           项目,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=5;
内容=           内容||DECODE(标志,NULL,'',DECODE(SUBSTR(标志,3,100),'正常','','异常','(+)','偏低','↓','偏高','↑')) AS 内容,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=6;
内容=           参考,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=7;
内容=           DECODE(标志,NULL,'',SUBSTR(标志,3,100)) AS 提示,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=8;
内容=           排列序号,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=9;
内容=           元素内序号  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=10;
内容=    FROM (  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=11;
内容=    SELECT  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=12;
内容=           项目,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=13;
内容=           内容,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=14;
内容=           DECODE(SIGN(INSTR(参考,'''')),1,SUBSTR(参考,1,INSTR(参考,'''')-1),'') AS 标志,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=15;
内容=           DECODE(SIGN(INSTR(参考,'''')),1,SUBSTR(参考,INSTR(参考,'''')+1,1000),'') AS 参考,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=16;
内容=           排列序号,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=17;
内容=           元素内序号  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=18;
内容=    FROM (  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=19;
内容=    SELECT  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=20;
内容=           项目,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=21;
内容=           DECODE(SIGN(INSTR(内容,'''')),1,SUBSTR(内容,1,INSTR(内容,'''')-1),内容) AS 内容,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=22;
内容=           DECODE(SIGN(INSTR(内容,'''')),1,SUBSTR(内容,INSTR(内容,'''')+1,1000),'') AS 参考,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=23;
内容=           排列序号,  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=24;
内容=           元素内序号 ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=25;
内容=    FROM (  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=26;
内容=    SELECT C.中文名 AS 项目,DECODE(A.所见内容,NULL,NULL,A.所见内容||' '||DECODE(C.单位,NULL,'',C.单位)) AS 内容,B.排列序号,A.控件号 AS 元素内序号 FROM 病人病历所见单 A,病人病历内容 B,诊治所见项目 C  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=27;
内容=    Where A.病历ID = B.ID  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=28;
内容=          AND B.病历记录ID In (Select Distinct S.报告id From 病人医嘱发送 S Where S.No=[0] And S.记录性质=[1]);
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=29;
内容=          AND C.ID=A.所见项ID  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=30;
内容=    )))  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=31;
内容=    Union All  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=32;
内容=    SELECT B.标题文本 AS 项目,A.内容,'' AS 参考,'' AS 提示,B.排列序号,0 AS 元素内序号 FROM 病人病历文本段 A,病人病历内容 B  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=33;
内容=    Where A.病历ID = B.ID  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=34;
内容=            And B.病历记录ID In (Select Distinct S.报告id From 病人医嘱发送 S Where S.No=[0] And S.记录性质=[1]);
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=35;
内容=;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=36;
内容=          AND 元素类型 IN (0,-5)  ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=37;
内容=    ) ORDER BY 排列序号,元素内序号;
[ZLRPTPARS]
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=0;
名称=NO;
类型=0;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=1;
名称=性质;
类型=1;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
[ZLRPTDATAS]
;
ID=[NextVal];
报表ID=[zlReports_ID.CurrVal];
名称=体检小结;
字段=结果,200|检查医生,200|检查日期,200;
对象=USER.病人病历文本段,USER.病人医嘱发送,USER.病人病历内容,USER.病人病历记录,USER.病历元素目录;
类型=0;
[ZLRPTSQLS]
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=1;
内容=;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=2;
内容=SELECT 	结果,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=3;
内容=        书写人 As 检查医生,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=4;
内容=        TO_CHAR(书写日期,'yyyy-mm-dd') AS 检查日期;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=5;
内容=FROM (;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=6;
内容=      ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=7;
内容=select     ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=8;
内容=       X.排列序号,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=9;
内容=       X1.内序号,        ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=10;
内容=       X.标题文本 AS 项目,       ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=11;
内容=       X1.结果,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=12;
内容=       Y.书写人,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=13;
内容=       Y.书写日期    ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=14;
内容=from ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=15;
内容=     病人病历内容 X, ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=16;
内容=     病人病历记录 Y,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=17;
内容=     病历元素目录 z,;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=18;
内容=      (;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=19;
内容=      select 病历id,0 AS 内序号,'' AS 项目,内容 AS 结果 from 病人病历文本段   ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=20;
内容=      ) X1;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=21;
内容=where X.病历记录id In (Select Distinct S.报告id From 病人医嘱发送 S Where S.No=[0] And S.记录性质=[1]);
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=22;
内容=      AND X.ID=X1.病历id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=23;
内容=      AND Y.ID=X.病历记录id;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=24;
内容=      AND X.元素类型=4 and X.元素编码=z.编码 and Upper(z.部件)='ZL9CISCORE.USRMEDICALGROUP'         ;
;
源ID=[zlRPTDatas_ID.CurrVal];
行号=25;
内容=) ORDER BY  排列序号,内序号 ;
[ZLRPTPARS]
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=0;
名称=NO;
类型=0;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;
;
源ID=[zlRPTDatas_ID.CurrVal];
组名=;
序号=1;
名称=性质;
类型=1;
缺省值=;
格式=0;
值列表=;
分类SQL=;
明细SQL=;
分类字段=;
明细字段=;
对象=;

--[连续升级]1
--[管理工具版本号]10.35.80
--本脚本支持从ZLHIS+ v10.35.70 升级到 v10.35.80
--请以系统所有者登录PLSQL并执行下列脚本
--脚本执行后，请手工升级导出报表
Define n_System=100;
-------------------------------------------------------------------------------
--结构修正部份
-------------------------------------------------------------------------------
--95531:刘硕,2016-04-29,消息集成的数据结构与基础数据
Declare
  v_Count Number;
  v_Path  Varchar2(255);
Begin
  --检查是否存在该表空间
  Select Count(*) Into v_Count From Dba_Tablespaces Where Upper(Tablespace_Name) = Upper('zlMsgData');
  If Nvl(v_Count, 0) = 0 Then
    --寻找基准表空间，以ZLTOOLS的表空间为基准，寻找文件路径，注意路径区分Win系统与Linux系统
    Select Substr(File_Name,
                   1,
                   Decode(Instr(File_Name, '\', -1), 0, Instr(File_Name, '/', -1), Instr(File_Name, '\', -1)))
    Into v_Path
    From Dba_Data_Files
    Where Upper(Tablespace_Name) = Upper('zlToolsTbs') And Rownum < 2;
  
    Execute Immediate 'Create Tablespace zlMsgData Datafile ''' || v_Path ||
                      'zlMsgData.DBF'' SIZE 50M REUSE AUTOEXTEND ON NEXT 5M  EXTENT MANAGEMENT LOCAL AUTOALLOCATE';
  End If;
End;
/


-------------------------------------------------------------------------------
--数据修正部份
-------------------------------------------------------------------------------





-------------------------------------------------------------------------------
--权限修正部份
-------------------------------------------------------------------------------





-------------------------------------------------------------------------------
--报表修正部份
-------------------------------------------------------------------------------






-------------------------------------------------------------------------------
--过程修正部份
-------------------------------------------------------------------------------





---------------------------------------------------------------------------------------------------
--更改系统及部件的版本号
-------------------------------------------------------------------------------------------------------

Commit;
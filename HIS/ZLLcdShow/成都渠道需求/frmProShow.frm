VERSION 5.00
Object = "{BEEECC20-4D5F-4F8B-BFDC-5D9B6FBDE09D}#1.0#0"; "vsflex8.ocx"
Begin VB.Form frmProShow 
   BorderStyle     =   0  'None
   ClientHeight    =   8115
   ClientLeft      =   0
   ClientTop       =   0
   ClientWidth     =   11655
   LinkTopic       =   "Form1"
   ScaleHeight     =   8115
   ScaleWidth      =   11655
   ShowInTaskbar   =   0   'False
   StartUpPosition =   3  '´°¿ÚÈ±Ê¡
   Begin VB.Timer timRest 
      Interval        =   8000
      Left            =   7560
      Top             =   6480
   End
   Begin VB.Timer timData 
      Interval        =   1000
      Left            =   8520
      Top             =   6480
   End
   Begin VB.Timer timTime 
      Interval        =   60000
      Left            =   9600
      Top             =   6480
   End
   Begin VSFlex8Ctl.VSFlexGrid vsf´ýÈ¡Ò© 
      Height          =   4455
      Left            =   360
      TabIndex        =   0
      Top             =   1560
      Width           =   5385
      _cx             =   9499
      _cy             =   7858
      Appearance      =   1
      BorderStyle     =   0
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   16777215
      ForeColor       =   0
      BackColorFixed  =   -2147483643
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483643
      BackColorAlternate=   16777215
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   0
      HighLight       =   0
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   1
      GridLines       =   0
      GridLinesFixed  =   0
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   0
      FixedCols       =   0
      RowHeightMin    =   600
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   -1  'True
      FormatString    =   $"frmProShow.frx":0000
      ScrollTrack     =   0   'False
      ScrollBars      =   0
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      AutoSearchDelay =   2
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0
      ShowComboButton =   1
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
      DataMember      =   ""
      ComboSearch     =   3
      AutoSizeMouse   =   -1  'True
      FrozenRows      =   0
      FrozenCols      =   0
      AllowUserFreezing=   0
      BackColorFrozen =   0
      ForeColorFrozen =   0
      WallPaperAlignment=   9
      AccessibleName  =   ""
      AccessibleDescription=   ""
      AccessibleValue =   ""
      AccessibleRole  =   24
   End
   Begin VB.PictureBox picDraw 
      AutoRedraw      =   -1  'True
      BorderStyle     =   0  'None
      Height          =   1035
      Left            =   3240
      ScaleHeight     =   1035
      ScaleWidth      =   1800
      TabIndex        =   1
      Top             =   7320
      Visible         =   0   'False
      Width           =   1800
   End
   Begin VSFlex8Ctl.VSFlexGrid vsfÒÑ¹ýºÅ 
      Height          =   4455
      Left            =   7080
      TabIndex        =   2
      Top             =   1560
      Width           =   4185
      _cx             =   7382
      _cy             =   7858
      Appearance      =   1
      BorderStyle     =   0
      Enabled         =   -1  'True
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      MousePointer    =   0
      BackColor       =   16777215
      ForeColor       =   0
      BackColorFixed  =   -2147483643
      ForeColorFixed  =   -2147483630
      BackColorSel    =   -2147483635
      ForeColorSel    =   -2147483634
      BackColorBkg    =   -2147483643
      BackColorAlternate=   16777215
      GridColor       =   -2147483633
      GridColorFixed  =   -2147483632
      TreeColor       =   -2147483632
      FloodColor      =   192
      SheetBorder     =   -2147483642
      FocusRect       =   0
      HighLight       =   0
      AllowSelection  =   -1  'True
      AllowBigSelection=   -1  'True
      AllowUserResizing=   0
      SelectionMode   =   1
      GridLines       =   0
      GridLinesFixed  =   0
      GridLineWidth   =   1
      Rows            =   50
      Cols            =   10
      FixedRows       =   0
      FixedCols       =   0
      RowHeightMin    =   600
      RowHeightMax    =   0
      ColWidthMin     =   0
      ColWidthMax     =   0
      ExtendLastCol   =   -1  'True
      FormatString    =   $"frmProShow.frx":0152
      ScrollTrack     =   0   'False
      ScrollBars      =   0
      ScrollTips      =   0   'False
      MergeCells      =   0
      MergeCompare    =   0
      AutoResize      =   -1  'True
      AutoSizeMode    =   0
      AutoSearch      =   0
      AutoSearchDelay =   2
      MultiTotals     =   -1  'True
      SubtotalPosition=   1
      OutlineBar      =   0
      OutlineCol      =   0
      Ellipsis        =   0
      ExplorerBar     =   0
      PicturesOver    =   0   'False
      FillStyle       =   0
      RightToLeft     =   0   'False
      PictureType     =   0
      TabBehavior     =   0
      OwnerDraw       =   0
      Editable        =   0
      ShowComboButton =   1
      WordWrap        =   0   'False
      TextStyle       =   0
      TextStyleFixed  =   0
      OleDragMode     =   0
      OleDropMode     =   0
      DataMode        =   0
      VirtualData     =   -1  'True
      DataMember      =   ""
      ComboSearch     =   3
      AutoSizeMouse   =   -1  'True
      FrozenRows      =   0
      FrozenCols      =   0
      AllowUserFreezing=   0
      BackColorFrozen =   0
      ForeColorFrozen =   0
      WallPaperAlignment=   9
      AccessibleName  =   ""
      AccessibleDescription=   ""
      AccessibleValue =   ""
      AccessibleRole  =   24
   End
   Begin VB.Label lblÎÂÜ°ÌáÊ¾ 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ÎÂÜ°ÌáÊ¾£ºÇëÄÍÐÄµÈºò£¬ÒÀ´ÎÅÅ¶Ó¡£×£ÄúÔçÈÕ¿µ¸´£¡"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   360
      TabIndex        =   5
      Top             =   6240
      Width           =   5520
   End
   Begin VB.Label lblTime 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "2019-01-01 00:00"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7560
      TabIndex        =   10
      Top             =   7080
      Width           =   1965
   End
   Begin VB.Label lblºô½Ð_´°¿Ú 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Ò»ºÅ´°¿Ú"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7800
      TabIndex        =   9
      Top             =   600
      Width           =   960
   End
   Begin VB.Label lblºô½Ð_µ½ 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "µ½"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   7320
      TabIndex        =   8
      Top             =   600
      Width           =   240
   End
   Begin VB.Label lblºô½Ð_ÐÕÃû 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "³ÂÎÞÃ÷"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   6240
      TabIndex        =   7
      Top             =   600
      Width           =   720
   End
   Begin VB.Label lblºô½Ð_Çë 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Çë"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   5760
      TabIndex        =   6
      Top             =   600
      Width           =   240
   End
   Begin VB.Label lblºô½Ð_È¡Ò© 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "È¡Ò©"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   9240
      TabIndex        =   4
      Top             =   600
      Width           =   480
   End
   Begin VB.Label lblÒ©·¿Ãû³Æ 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "ÃÅÕïÎ÷Ò©·¿"
      BeginProperty Font 
         Name            =   "Î¢ÈíÑÅºÚ"
         Size            =   12
         Charset         =   134
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   315
      Left            =   840
      TabIndex        =   3
      Top             =   600
      Width           =   1200
   End
   Begin VB.Image img±³¾° 
      Appearance      =   0  'Flat
      Height          =   855
      Left            =   3360
      Stretch         =   -1  'True
      Top             =   360
      Width           =   1065
   End
End
Attribute VB_Name = "frmProShow"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private mlngÒ©·¿ID As Long          'µ±Ç°Ò©·¿ID
Private mstrWins As String          'µ±Ç°·¢Ò©´°¿Ú
Private mblnÅäÒ© As Boolean         'ÊÇ·ñÅäÒ©
Private mblnÅäÒ©È·ÈÏ As Boolean     'ÊÇ·ñÅäÒ©È·ÈÏ
Private mblnÕýÔÚÏÔÊ¾ As Boolean     'ºô½ÐÄÚÈÝÊÇ·ñÕýÔÚÏÔÊ¾

Private Const CST_STR_REG As String = "¹«¹²Ä£¿é\Ò©·¿ÅÅ¶Ó½ÐºÅ\Òº¾§µçÊÓPro"

Private Type Type_para
    blnµ¥´°¿ÚÄ£Ê½ As Boolean          'ÆÁÄ»´°¿ÚÏÔÊ¾Ä£Ê½¡£True-µ¥´°¿ÚÏÔÊ¾£»False-¶à´°¿ÚÏÔÊ¾
    str¶à´°¿Ú As String               '¶à´°¿ÚÄ£Ê½ÏÂËùÉèÖÃµÄ¸÷´°¿Ú
    
    str±³¾°Í¼Æ¬µØÖ· As String         '±¾µØ±³¾°Í¼Æ¬·ÃÎÊµØÖ·
    
    'Ö÷´°ÌåÎ»ÖÃ
    lngLeft As Long                  'Ö÷´°Ìå¾àÏÔÊ¾ÆÁ×ó±ßÎ»ÖÃ
    lngTop  As Long                 'Ö÷´°Ìå¾àÏÔÊ¾ÆÁÉÏ±ßÎ»ÖÃ
    lngWidth As Long                'Ö÷´°Ìå¿í¶È
    lngHeight As Long               'Ö÷´°Ìå¸ß¶È
    
    'Êý¾ÝË¢ÐÂ
    intÊý¾ÝÂÖÑ¯Ê±¼ä As Integer
    intºô½ÐÏÔÊ¾Ê±¼ä As Integer
    
    'Ò©·¿Ïà¹ØÉèÖÃ
    lngÒ©·¿_Left As Long
    lngÒ©·¿_Top As Long
    
    strÒ©·¿_×ÖÌå As String
    strÒ©·¿_×ÖºÅ As String
    blnÒ©·¿_´ÖÌå As Boolean
    blnÒ©·¿_Ð±Ìå As Boolean
    lngÒ©·¿_ÑÕÉ« As Long
    
    'ºô½ÐÄÚÈÝÏà¹ØÉèÖÃ
    lngºô½Ð_Left As Long
    lngºô½Ð_Top As Long
    
    strºô½ÐÍ¨ÓÃ_×ÖÌå As String
    strºô½ÐÍ¨ÓÃ_×ÖºÅ As String
    blnºô½ÐÍ¨ÓÃ_´ÖÌå As Boolean
    blnºô½ÐÍ¨ÓÃ_Ð±Ìå As Boolean
    lngºô½ÐÍ¨ÓÃ_ÑÕÉ« As Long
    
    blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ As Boolean
    strºô½ÐÐÕÃû_×ÖÌå As String
    strºô½ÐÐÕÃû_×ÖºÅ As String
    blnºô½ÐÐÕÃû_´ÖÌå As Boolean
    blnºô½ÐÐÕÃû_Ð±Ìå As Boolean
    lngºô½ÐÐÕÃû_ÑÕÉ« As Long
    
    blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ As Boolean
    strºô½Ð´°¿Ú_×ÖÌå As String
    strºô½Ð´°¿Ú_×ÖºÅ As String
    blnºô½Ð´°¿Ú_´ÖÌå As Boolean
    blnºô½Ð´°¿Ú_Ð±Ìå As Boolean
    lngºô½Ð´°¿Ú_ÑÕÉ« As Long
    
    '´ý·¢Ò©ÇøÓòÏà¹ØÉèÖÃ
    blnÏÔÊ¾´ý·¢Ò© As Boolean
    
    lng´ý·¢Ò©_Left As Long
    lng´ý·¢Ò©_Top As Long
    
    str´ý·¢Ò©_×ÖÌå As String
    str´ý·¢Ò©_×ÖºÅ As String
    bln´ý·¢Ò©_´ÖÌå As Boolean
    bln´ý·¢Ò©_Ð±Ìå As Boolean
    lng´ý·¢Ò©_ÑÕÉ« As Long
    
    lng´ý·¢Ò©_ÁÐ¿í As Long
    lng´ý·¢Ò©_ÐÐ¸ß As Long
    lng´ý·¢Ò©_ÐÐÊý As Long
    
    'ÒÑ¹ýºÅÇøÓòÏà¹ØÉèÖÃ
    blnÏÔÊ¾ÒÑ¹ýºÅ As Boolean
    
    lngÒÑ¹ýºÅ_Left As Long
    lngÒÑ¹ýºÅ_Top As Long
    
    strÒÑ¹ýºÅ_×ÖÌå As String
    strÒÑ¹ýºÅ_×ÖºÅ As String
    blnÒÑ¹ýºÅ_´ÖÌå As Boolean
    blnÒÑ¹ýºÅ_Ð±Ìå As Boolean
    lngÒÑ¹ýºÅ_ÑÕÉ« As Long
    
    lngÒÑ¹ýºÅ_ÁÐ¿í As Long
    lngÒÑ¹ýºÅ_ÐÐ¸ß As Long
    lngÒÑ¹ýºÅ_ÐÐÊý As Long
    
    'ÎÂÜ°ÌáÊ¾ÄÚÈÝ
    blnÏÔÊ¾ÌáÊ¾ As Boolean
    lngÎÂÜ°ÌáÊ¾_Left As Long
    lngÎÂÜ°ÌáÊ¾_Top As Long
    
    strÎÂÜ°ÌáÊ¾_ÄÚÈÝ As String             'ÏÔÊ¾ÆÁÏÂ·½µÄÎÂÜ°ÌáÊ¾ÄÚÈÝ£¨Ä¬ÈÏÖ¸ÏÂ·½ÇøÓò£©
    
    strÎÂÜ°ÌáÊ¾_×ÖÌå As String
    strÎÂÜ°ÌáÊ¾_×ÖºÅ As String
    blnÎÂÜ°ÌáÊ¾_´ÖÌå As Boolean
    blnÎÂÜ°ÌáÊ¾_Ð±Ìå As Boolean
    lngÎÂÜ°ÌáÊ¾_ÑÕÉ« As Long
    
    'Ê±¼ä
    blnÏÔÊ¾Ê±¼ä As Boolean
    
    lngÊ±¼ä_Left As Long
    lngÊ±¼ä_Top As Long
    
    strÊ±¼ä_×ÖÌå As String
    strÊ±¼ä_×ÖºÅ As String
    blnÊ±¼ä_´ÖÌå As Boolean
    blnÊ±¼ä_Ð±Ìå As Boolean
    lngÊ±¼ä_ÑÕÉ« As Long
End Type

Private mPara As Type_para

Public Sub ShowMe(ByVal lngÒ©·¿ID As Long, ByVal strWins As String, ByVal blnÅäÒ© As Boolean, ByVal blnÅäÒ©È·ÈÏ As Boolean)
    '¹¦ÄÜ£º¶ÔÄ£¿é½øÐÐ³õÊ¼»¯
    
    mlngÒ©·¿ID = lngÒ©·¿ID
    mstrWins = strWins
    mblnÅäÒ© = blnÅäÒ©
    mblnÅäÒ©È·ÈÏ = blnÅäÒ©È·ÈÏ
    
    '´°ÌåÏÔÊ¾
    Me.Show
End Sub

Private Sub Changeºô½ÐÄÚÈÝ()
    '¹¦ÄÜ£º¸üÐÂÏÔÊ¾ÆÁµÄºô½ÐÄÚÈÝ
    Dim strSQL As String
    Dim strWins As String
    Dim date¿ªÊ¼ÈÕÆÚ As Date
    Dim date½áÊøÈÕÆÚ As Date

    Dim rsData As ADODB.Recordset
    
    On Error GoTo errHandle
    
    If mblnÕýÔÚÏÔÊ¾ Then Exit Sub
    
    strWins = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, mstrWins, mPara.str¶à´°¿Ú)
    
    date¿ªÊ¼ÈÕÆÚ = gobjDatabase.Currentdate
    date¿ªÊ¼ÈÕÆÚ = CDate(Format(date¿ªÊ¼ÈÕÆÚ, "yyyy-mm-dd") & " 00:00:00")

    date½áÊøÈÕÆÚ = gobjDatabase.Currentdate
    date½áÊøÈÕÆÚ = CDate(Format(date½áÊøÈÕÆÚ, "yyyy-mm-dd") & " 23:59:59")
    
    strSQL = "Select ÐÕÃû, ·¢Ò©´°¿Ú, NO, µ¥¾Ý, ¿â·¿id" & vbNewLine & _
            "From (Select ÐÕÃû, ·¢Ò©´°¿Ú, NO, µ¥¾Ý, ¿â·¿id" & vbNewLine & _
            "       From Î´·¢Ò©Æ·¼ÇÂ¼" & vbNewLine & _
            "       Where (ÅÅ¶Ó×´Ì¬ = 3 Or ÅÅ¶Ó×´Ì¬ = 4) And Nvl(ÏÔÊ¾×´Ì¬, 0) = 0 And ¿â·¿id = [1]" & vbNewLine & _
            "       And ·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) And ÌîÖÆÈÕÆÚ Between [3] And [4]" & vbNewLine & _
            "       Order By ºô½ÐÊ±¼ä) A" & vbNewLine & _
            "Where Rownum < 2"
        
    Set rsData = gobjDatabase.OpenSQLRecord(strSQL, "¼ÓÔØÕýºô½ÐÊý¾Ý", mlngÒ©·¿ID, strWins, date¿ªÊ¼ÈÕÆÚ, date½áÊøÈÕÆÚ)
    
    If rsData.EOF Then Exit Sub
    
    lblºô½Ð_ÐÕÃû.Caption = rsData!ÐÕÃû
    lblºô½Ð_´°¿Ú.Caption = rsData!·¢Ò©´°¿Ú
    
    mblnÕýÔÚÏÔÊ¾ = True
    
    timRest.Enabled = False
    timRest.Enabled = True
    
    Call Initºô½ÐÄÚÈÝ
    Call Showºô½ÐÄÚÈÝ(True)
    
    'ºô½ÐÍêºóÇå³ýºô½ÐÄÚÈÝ£¬·ÅÔÚË¢ÐÂÏÔÊ¾µÄ´¦ÀíºóÃæ
    strSQL = "Zl_Î´·¢Ò©Æ·¼ÇÂ¼_ÏÔÊ¾("
    'NO
    strSQL = strSQL & "'" & rsData!NO & "'"
    'µ¥¾Ý
    strSQL = strSQL & "," & rsData!µ¥¾Ý
    'Ò©·¿id
    strSQL = strSQL & "," & rsData!¿â·¿id
    strSQL = strSQL & ")"
    
    Call gobjDatabase.ExecuteProcedure(strSQL, "tmrCall_Timer")
    
    Exit Sub
errHandle:
    If gobjComLib.ErrCenter() = 1 Then
        Resume
    End If
    Call gobjComLib.SaveErrLog
End Sub

Public Sub Reset()
    '¹¦ÄÜ£ºÖØÖÃ½çÃæ²¼¾Ö
    
    Call LoadPar
    Call ResetLayout
    Call DrawWallPaper
End Sub

Private Sub LoadPar()
    '¹¦ÄÜ£º»ñÈ¡²ÎÊýÉèÖÃ
    
    With mPara
        .blnµ¥´°¿ÚÄ£Ê½ = (Val(GetSetting("ZLSOFT", CST_STR_REG, "´°¿ÚÄ£Ê½", "0")) = 0)
        .str¶à´°¿Ú = GetSetting("ZLSOFT", CST_STR_REG, "¶à´°¿Ú", "")
        .str±³¾°Í¼Æ¬µØÖ· = GetSetting("ZLSOFT", CST_STR_REG, "Í¼Æ¬Î»ÖÃ", "")
        
        'Ö÷´°ÌåÎ»ÖÃ
        .lngLeft = GetSetting("ZLSOFT", CST_STR_REG, "Òº¾§ÆÁ_×ó", "1024")
        .lngTop = GetSetting("ZLSOFT", CST_STR_REG, "Òº¾§ÆÁ_¶¥", "0")
        .lngWidth = GetSetting("ZLSOFT", CST_STR_REG, "Òº¾§ÆÁ_¿í¶È", "1024")
        .lngHeight = GetSetting("ZLSOFT", CST_STR_REG, "Òº¾§ÆÁ_¸ß¶È", "768")
        
        'Êý¾ÝË¢ÐÂ
        .intÊý¾ÝÂÖÑ¯Ê±¼ä = Val(GetSetting("ZLSOFT", CST_STR_REG, "Êý¾ÝÂÖÑ¯Ê±¼ä", "1"))
        If .intÊý¾ÝÂÖÑ¯Ê±¼ä < 1 Then
            .intÊý¾ÝÂÖÑ¯Ê±¼ä = 1
        ElseIf .intÊý¾ÝÂÖÑ¯Ê±¼ä > 60 Then
            .intÊý¾ÝÂÖÑ¯Ê±¼ä = 60
        End If
        
        'ÏÔÊ¾Ë¢ÐÂ
        .intºô½ÐÏÔÊ¾Ê±¼ä = Val(GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÏÔÊ¾Ê±¼ä", "1"))
        If .intºô½ÐÏÔÊ¾Ê±¼ä < 1 Then
            .intºô½ÐÏÔÊ¾Ê±¼ä = 1
        ElseIf .intºô½ÐÏÔÊ¾Ê±¼ä > 60 Then
            .intºô½ÐÏÔÊ¾Ê±¼ä = 60
        End If
        
        'Ò©·¿Ïà¹ØÉèÖÃ
        .lngÒ©·¿_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿_×ó", "0"))
        .lngÒ©·¿_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿_¶¥", "0"))
        
        .strÒ©·¿_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿×ÖÌå", "Î¢ÈíÑÅºÚ")
        .strÒ©·¿_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿×ÖºÅ", "12")
        .blnÒ©·¿_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿´ÖÌå", "False")
        .blnÒ©·¿_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿Ð±Ìå", "False")
        .lngÒ©·¿_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "Ò©·¿ÑÕÉ«", vbBlack)
        
        'ºô½ÐÄÚÈÝÏà¹ØÉèÖÃ
        .lngºô½Ð_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð_×ó", "0"))
        .lngºô½Ð_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð_¶¥", "0"))
        
        .strºô½ÐÍ¨ÓÃ_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð×ÖÌå_Í¨ÓÃ", "Î¢ÈíÑÅºÚ")
        .strºô½ÐÍ¨ÓÃ_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÍ¨ÓÃ×ÖÌå_×ÖºÅ", "12")
        .blnºô½ÐÍ¨ÓÃ_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÍ¨ÓÃ×ÖÌå_´ÖÌå", "False")
        .blnºô½ÐÍ¨ÓÃ_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÍ¨ÓÃ×ÖÌå_Ð±Ìå", "False")
        .lngºô½ÐÍ¨ÓÃ_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÑÕÉ«_Í¨ÓÃ", vbBlack)
        
        .blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ", "0")) = 1)
        .strºô½ÐÐÕÃû_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð×ÖÌå_ÐÕÃû", "Î¢ÈíÑÅºÚ")
        .strºô½ÐÐÕÃû_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÐÕÃû×ÖÌå_×ÖºÅ", "12")
        .blnºô½ÐÐÕÃû_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÐÕÃû×ÖÌå_´ÖÌå", "False")
        .blnºô½ÐÐÕÃû_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÐÕÃû×ÖÌå_Ð±Ìå", "False")
        .lngºô½ÐÐÕÃû_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÑÕÉ«_ÐÕÃû", vbBlack)
        
        .blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð´°¿Úµ¥¶ÀÉèÖÃ", "0")) = 1)
        .strºô½Ð´°¿Ú_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð×ÖÌå_´°¿Ú", "Î¢ÈíÑÅºÚ")
        .strºô½Ð´°¿Ú_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð´°¿Ú×ÖÌå_×ÖºÅ", "12")
        .blnºô½Ð´°¿Ú_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð´°¿Ú×ÖÌå_´ÖÌå", "False")
        .blnºô½Ð´°¿Ú_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "ºô½Ð´°¿Ú×ÖÌå_Ð±Ìå", "False")
        .lngºô½Ð´°¿Ú_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "ºô½ÐÑÕÉ«_´°¿Ú", vbBlack)
        
        '´ý·¢Ò©ÇøÓòÏà¹ØÉèÖÃ
        .blnÏÔÊ¾´ý·¢Ò© = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ÏÔÊ¾´ý·¢Ò©", "1")) = 1)
        
        .lng´ý·¢Ò©_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©_×ó", "0"))
        .lng´ý·¢Ò©_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©_¶¥", "0"))
        
        .str´ý·¢Ò©_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©×ÖÌå", "Î¢ÈíÑÅºÚ")
        .str´ý·¢Ò©_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©×ÖºÅ", "12")
        .bln´ý·¢Ò©_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©´ÖÌå", "False")
        .bln´ý·¢Ò©_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©Ð±Ìå", "False")
        .lng´ý·¢Ò©_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©ÑÕÉ«", vbBlack)
        
        .lng´ý·¢Ò©_ÁÐ¿í = Val(GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©_ÁÐ¿í", "800"))
        .lng´ý·¢Ò©_ÐÐ¸ß = Val(GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©_ÐÐ¸ß", "350"))
        .lng´ý·¢Ò©_ÐÐÊý = Val(GetSetting("ZLSOFT", CST_STR_REG, "´ý·¢Ò©_ÐÐÊý", "5"))
        
        'ÒÑ¹ýºÅÇøÓòÏà¹ØÉèÖÃ
        .blnÏÔÊ¾ÒÑ¹ýºÅ = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ÏÔÊ¾ÒÑ¹ýºÅ", "1")) = 1)
        
        .lngÒÑ¹ýºÅ_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ_×ó", "0"))
        .lngÒÑ¹ýºÅ_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ_¶¥", "0"))
        
        .strÒÑ¹ýºÅ_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ×ÖÌå", "Î¢ÈíÑÅºÚ")
        .strÒÑ¹ýºÅ_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ×ÖºÅ", "12")
        .blnÒÑ¹ýºÅ_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ´ÖÌå", "False")
        .blnÒÑ¹ýºÅ_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅÐ±Ìå", "False")
        .lngÒÑ¹ýºÅ_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅÑÕÉ«", vbBlack)
        
        .lngÒÑ¹ýºÅ_ÁÐ¿í = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ_ÁÐ¿í", "800"))
        .lngÒÑ¹ýºÅ_ÐÐ¸ß = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ_ÐÐ¸ß", "350"))
        .lngÒÑ¹ýºÅ_ÐÐÊý = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÒÑ¹ýºÅ_ÐÐÊý", "5"))
        
        'ÎÂÜ°ÌáÊ¾ÄÚÈÝ
        .blnÏÔÊ¾ÌáÊ¾ = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ÏÔÊ¾ÌáÊ¾", "1")) = 1)
        .lngÎÂÜ°ÌáÊ¾_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾_×ó", "0"))
        .lngÎÂÜ°ÌáÊ¾_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾_¶¥", "0"))
        
        .strÎÂÜ°ÌáÊ¾_ÄÚÈÝ = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾_ÄÚÈÝ", "")
        
        .strÎÂÜ°ÌáÊ¾_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾×ÖÌå", "Î¢ÈíÑÅºÚ")
        .strÎÂÜ°ÌáÊ¾_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾×ÖºÅ", "12")
        .blnÎÂÜ°ÌáÊ¾_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾´ÖÌå", "False")
        .blnÎÂÜ°ÌáÊ¾_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾Ð±Ìå", "False")
        .lngÎÂÜ°ÌáÊ¾_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "ÌáÊ¾ÑÕÉ«", vbBlack)
        
        'Ê±¼ä
        .blnÏÔÊ¾Ê±¼ä = (Val(GetSetting("ZLSOFT", CST_STR_REG, "ÏÔÊ¾Ê±¼ä", "1")) = 1)
        
        .lngÊ±¼ä_Left = Val(GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼ä_×ó", "0"))
        .lngÊ±¼ä_Top = Val(GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼ä_¶¥", "0"))
        
        .strÊ±¼ä_×ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼ä×ÖÌå", "Î¢ÈíÑÅºÚ")
        .strÊ±¼ä_×ÖºÅ = GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼ä×ÖºÅ", "12")
        .blnÊ±¼ä_´ÖÌå = GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼ä´ÖÌå", "False")
        .blnÊ±¼ä_Ð±Ìå = GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼äÐ±Ìå", "False")
        .lngÊ±¼ä_ÑÕÉ« = GetSetting("ZLSOFT", CST_STR_REG, "Ê±¼äÑÕÉ«", vbBlack)
            
    End With
    
End Sub

Private Sub Initºô½ÐÄÚÈÝ()
    '¹¦ÄÜ£ºÖØÖÃºô½ÐÄÚÈÝµÄÎ»ÖÃ¼°ÑùÊ½
    
    With lblºô½Ð_Çë
        .FontName = mPara.strºô½ÐÍ¨ÓÃ_×ÖÌå
        .FontSize = mPara.strºô½ÐÍ¨ÓÃ_×ÖºÅ
        .FontBold = mPara.blnºô½ÐÍ¨ÓÃ_´ÖÌå
        .FontItalic = mPara.blnºô½ÐÍ¨ÓÃ_Ð±Ìå
        .ForeColor = mPara.lngºô½ÐÍ¨ÓÃ_ÑÕÉ«
        
        .Left = mPara.lngºô½Ð_Left
        .Top = mPara.lngºô½Ð_Top
    End With
    
    With lblºô½Ð_ÐÕÃû
        .FontName = IIf(mPara.blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ, mPara.strºô½ÐÐÕÃû_×ÖÌå, mPara.strºô½ÐÍ¨ÓÃ_×ÖÌå)
        .FontSize = IIf(mPara.blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ, mPara.strºô½ÐÐÕÃû_×ÖºÅ, mPara.strºô½ÐÍ¨ÓÃ_×ÖºÅ)
        .FontBold = IIf(mPara.blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ, mPara.blnºô½ÐÐÕÃû_´ÖÌå, mPara.blnºô½ÐÍ¨ÓÃ_´ÖÌå)
        .FontItalic = IIf(mPara.blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ, mPara.blnºô½ÐÐÕÃû_Ð±Ìå, mPara.blnºô½ÐÍ¨ÓÃ_Ð±Ìå)
        .ForeColor = IIf(mPara.blnºô½ÐÐÕÃûµ¥¶ÀÉèÖÃ, mPara.lngºô½ÐÐÕÃû_ÑÕÉ«, mPara.lngºô½ÐÍ¨ÓÃ_ÑÕÉ«)
        
        .Left = lblºô½Ð_Çë.Left + lblºô½Ð_Çë.Width + 50
        .Top = lblºô½Ð_Çë.Top + (lblºô½Ð_Çë.Height - .Height) / 2
    End With
    
    With lblºô½Ð_µ½
        .FontName = mPara.strºô½ÐÍ¨ÓÃ_×ÖÌå
        .FontSize = mPara.strºô½ÐÍ¨ÓÃ_×ÖºÅ
        .FontBold = mPara.blnºô½ÐÍ¨ÓÃ_´ÖÌå
        .FontItalic = mPara.blnºô½ÐÍ¨ÓÃ_Ð±Ìå
        .ForeColor = mPara.lngºô½ÐÍ¨ÓÃ_ÑÕÉ«
        
        .Left = lblºô½Ð_ÐÕÃû.Left + lblºô½Ð_ÐÕÃû.Width + 50
        .Top = lblºô½Ð_Çë.Top
    End With
    
    With lblºô½Ð_´°¿Ú
        .FontName = IIf(mPara.blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ, mPara.strºô½Ð´°¿Ú_×ÖÌå, mPara.strºô½ÐÍ¨ÓÃ_×ÖÌå)
        .FontSize = IIf(mPara.blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ, mPara.strºô½Ð´°¿Ú_×ÖºÅ, mPara.strºô½ÐÍ¨ÓÃ_×ÖºÅ)
        .FontBold = IIf(mPara.blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ, mPara.blnºô½Ð´°¿Ú_´ÖÌå, mPara.blnºô½ÐÍ¨ÓÃ_´ÖÌå)
        .FontItalic = IIf(mPara.blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ, mPara.blnºô½Ð´°¿Ú_Ð±Ìå, mPara.blnºô½ÐÍ¨ÓÃ_Ð±Ìå)
        .ForeColor = IIf(mPara.blnºô½Ð´°¿Úµ¥¶ÀÉèÖÃ, mPara.lngºô½Ð´°¿Ú_ÑÕÉ«, mPara.lngºô½ÐÍ¨ÓÃ_ÑÕÉ«)
        
        .Left = lblºô½Ð_µ½.Left + lblºô½Ð_µ½.Width + 50
        .Top = lblºô½Ð_µ½.Top + (lblºô½Ð_µ½.Height - .Height) / 2
    End With
    
    With lblºô½Ð_È¡Ò©
        .FontName = mPara.strºô½ÐÍ¨ÓÃ_×ÖÌå
        .FontSize = mPara.strºô½ÐÍ¨ÓÃ_×ÖºÅ
        .FontBold = mPara.blnºô½ÐÍ¨ÓÃ_´ÖÌå
        .FontItalic = mPara.blnºô½ÐÍ¨ÓÃ_Ð±Ìå
        .ForeColor = mPara.lngºô½ÐÍ¨ÓÃ_ÑÕÉ«
        
        .Left = lblºô½Ð_´°¿Ú.Left + lblºô½Ð_´°¿Ú.Width + 50
        .Top = lblºô½Ð_Çë.Top
    End With
End Sub

Private Sub ResetLayout()
    '´°ÌåÎ»ÖÃ
    With Me
        .Left = mPara.lngLeft * Screen.TwipsPerPixelY
        .Top = mPara.lngTop * Screen.TwipsPerPixelY
        .Width = mPara.lngWidth * Screen.TwipsPerPixelX
        .Height = mPara.lngHeight * Screen.TwipsPerPixelY
    End With
    
    '±³¾°ÉèÖÃ
    With img±³¾°
        .Top = 0
        .Left = 0
        .Height = Me.ScaleHeight
        .Width = Me.ScaleWidth
        
        .Picture = LoadPicture(mPara.str±³¾°Í¼Æ¬µØÖ·)
    End With
    
    'Ò©·¿Ïà¹ØÉèÖÃ
    With lblÒ©·¿Ãû³Æ
        .Left = mPara.lngÒ©·¿_Left
        .Top = mPara.lngÒ©·¿_Top
        
        .FontName = mPara.strÒ©·¿_×ÖÌå
        .FontSize = mPara.strÒ©·¿_×ÖºÅ
        .FontBold = mPara.blnÒ©·¿_´ÖÌå
        .FontItalic = mPara.blnÒ©·¿_Ð±Ìå
        .ForeColor = mPara.lngÒ©·¿_ÑÕÉ«
    End With
    
    'Êý¾ÝÂÖÑ¯Ê±¼ä
    With timData
        .Interval = mPara.intÊý¾ÝÂÖÑ¯Ê±¼ä * 1000#
    End With
    
    'ºô½ÐÏÔÊ¾Ê±¼ä
    With timRest
        .Interval = mPara.intºô½ÐÏÔÊ¾Ê±¼ä * 1000#
    End With
    
    'ºô½ÐÄÚÈÝÏà¹ØÉèÖÃ
    Call Initºô½ÐÄÚÈÝ
    
    '´ý·¢Ò©ÇøÓòÏà¹ØÉèÖÃ
    Call InitList_´ý·¢Ò©
    
    'ÒÑ¹ýºÅÇøÓòÏà¹ØÉèÖÃ
    Call InitList_ÒÑ¹ýºÅ
    
    'ÎÂÜ°ÌáÊ¾ÄÚÈÝ
    With lblÎÂÜ°ÌáÊ¾
        .Visible = mPara.blnÏÔÊ¾ÌáÊ¾
        .Caption = mPara.strÎÂÜ°ÌáÊ¾_ÄÚÈÝ
        
        .FontName = mPara.strÎÂÜ°ÌáÊ¾_×ÖÌå
        .FontSize = mPara.strÎÂÜ°ÌáÊ¾_×ÖºÅ
        .FontBold = mPara.blnÎÂÜ°ÌáÊ¾_´ÖÌå
        .FontItalic = mPara.blnÎÂÜ°ÌáÊ¾_Ð±Ìå
        .ForeColor = mPara.lngÎÂÜ°ÌáÊ¾_ÑÕÉ«
        
        .Left = mPara.lngÎÂÜ°ÌáÊ¾_Left
        .Top = mPara.lngÎÂÜ°ÌáÊ¾_Top
    End With
    
    'Ê±¼ä
    With lblTime
        .Visible = mPara.blnÏÔÊ¾Ê±¼ä
        
        .Caption = Format(gobjDatabase.Currentdate, "yyyy-mm-dd  hh:mm")
        
        .FontName = mPara.strÊ±¼ä_×ÖÌå
        .FontSize = mPara.strÊ±¼ä_×ÖºÅ
        .FontBold = mPara.blnÊ±¼ä_´ÖÌå
        .FontItalic = mPara.blnÊ±¼ä_Ð±Ìå
        .ForeColor = mPara.lngÊ±¼ä_ÑÕÉ«
        
        .Left = mPara.lngÊ±¼ä_Left
        .Top = mPara.lngÊ±¼ä_Top
    End With
    
    With timTime
        .Enabled = mPara.blnÏÔÊ¾Ê±¼ä
    End With
    
End Sub

Private Sub Form_Load()
    mblnÕýÔÚÏÔÊ¾ = False
    
    Call Showºô½ÐÄÚÈÝ(False)
        
    '»ñÈ¡²ÎÊýÉèÖÃ
    Call LoadPar
    
    'ÖØÖÃ²¼¾Ö
    Call ResetLayout
    
    'ÖØ»æ±í¸ñ±³¾°
    Call DrawWallPaper
End Sub

Private Sub Showºô½ÐÄÚÈÝ(ByVal blnÏÔÊ¾ As Boolean)
    '¹¦ÄÜ£ºÊÇ·ñÏÔÊ¾ºô½ÐÄÚÈÝ
    
    lblºô½Ð_Çë.Visible = blnÏÔÊ¾
    lblºô½Ð_ÐÕÃû.Visible = blnÏÔÊ¾
    lblºô½Ð_µ½.Visible = blnÏÔÊ¾
    lblºô½Ð_´°¿Ú.Visible = blnÏÔÊ¾
    lblºô½Ð_È¡Ò©.Visible = blnÏÔÊ¾
End Sub


Private Sub InitList_´ý·¢Ò©()
    '¹¦ÄÜ£º³õÊ¼»¯´ý·¢Ò©ÁÐ±í
    Dim str´°¿Ú´® As String
    Dim i As Integer
    
    str´°¿Ú´® = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, mstrWins, mPara.str¶à´°¿Ú)
    
    With vsf´ýÈ¡Ò©
        .Visible = mPara.blnÏÔÊ¾´ý·¢Ò©
        .Left = mPara.lng´ý·¢Ò©_Left
        .Top = mPara.lng´ý·¢Ò©_Top
        
        'Êý¾ÝÇå¿Õ
        .Clear
        
        '¶¨ÒåÐÐÊý
        If mPara.blnµ¥´°¿ÚÄ£Ê½ Then
            .Rows = 1 + mPara.lng´ý·¢Ò©_ÐÐÊý
        Else
            .Rows = 4 + mPara.lng´ý·¢Ò©_ÐÐÊý
        End If
        
        '¶¨Òå±í¸ñµÄÁÐÊý
        .Cols = UBound(Split(str´°¿Ú´®, ",")) + 1
        
        '¶¨Òå±í¸ñÃ¿ÁÐKeyÖµ
        For i = 0 To UBound(Split(str´°¿Ú´®, ","))
            .ColKey(i) = Split(str´°¿Ú´®, ",")(i)
            
            If mPara.blnµ¥´°¿ÚÄ£Ê½ Then
                'ÏÔÊ¾¡°µÈ´ýÈ¡Ò©¡±
                .TextMatrix(0, i) = "µÈ´ýÈ¡Ò©"
            Else
                'ÏÔÊ¾¡°·¢Ò©´°¿Ú¡±
                .TextMatrix(0, i) = Split(str´°¿Ú´®, ",")(i)
                
                'ÏÔÊ¾¡°ÕýÔÚÈ¡Ò©¡±
                .TextMatrix(1, i) = "µ±Ç°È¡Ò©"
                
                'ÏÔÊ¾¡°µÈ´ýÈ¡Ò©¡±
                .TextMatrix(3, i) = "µÈ´ýÈ¡Ò©"
            End If
        Next
        
        '¾ÓÖÐÏÔÊ¾
        .ColAlignment(-1) = flexAlignCenterCenter
        
        '×ÖÌåÉèÖÃ
        .FontName = mPara.str´ý·¢Ò©_×ÖÌå
        .FontSize = mPara.str´ý·¢Ò©_×ÖºÅ
        .FontBold = mPara.bln´ý·¢Ò©_´ÖÌå
        .FontItalic = mPara.bln´ý·¢Ò©_Ð±Ìå
        .ForeColor = mPara.lng´ý·¢Ò©_ÑÕÉ«
        
        'µ¥Ôª¸ñÉèÖÃ
        .ColWidth(-1) = mPara.lng´ý·¢Ò©_ÁÐ¿í
        .RowHeight(-1) = mPara.lng´ý·¢Ò©_ÐÐ¸ß
        
        .Width = mPara.lng´ý·¢Ò©_ÁÐ¿í * .Cols
        .Height = mPara.lng´ý·¢Ò©_ÐÐ¸ß * .Rows
        
    End With
    
    'Êý¾Ý³õÊ¼»¯
    Call LoadData_´ý·¢Ò©
    
End Sub

Private Sub InitList_ÒÑ¹ýºÅ()
    '¹¦ÄÜ£º³õÊ¼»¯´ý·¢Ò©ÁÐ±í
    Dim str´°¿Ú´® As String
    Dim i As Integer
    
    str´°¿Ú´® = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, mstrWins, mPara.str¶à´°¿Ú)
    
    With vsfÒÑ¹ýºÅ
        .Visible = mPara.blnÏÔÊ¾ÒÑ¹ýºÅ
        .Left = mPara.lngÒÑ¹ýºÅ_Left
        .Top = mPara.lngÒÑ¹ýºÅ_Top
        
        'Êý¾ÝÇå¿Õ
        .Clear
    
        '¶¨ÒåÐÐÊý
        If mPara.blnµ¥´°¿ÚÄ£Ê½ Then
            .Rows = 1 + mPara.lng´ý·¢Ò©_ÐÐÊý
        Else
            .Rows = 2 + mPara.lngÒÑ¹ýºÅ_ÐÐÊý
        End If
        
        '¶¨Òå±í¸ñµÄÁÐÊý
        .Cols = UBound(Split(str´°¿Ú´®, ",")) + 1
    
        '¶¨Òå±í¸ñÃ¿ÁÐKeyÖµ
        For i = 0 To UBound(Split(str´°¿Ú´®, ","))
            .ColKey(i) = Split(str´°¿Ú´®, ",")(i)
            
            'ÏÔÊ¾¡°¹ýºÅÃûµ¥¡±
            .TextMatrix(0, i) = "¹ýºÅÃûµ¥"
            
            If Not mPara.blnµ¥´°¿ÚÄ£Ê½ Then
                'ÏÔÊ¾¡°·¢Ò©´°¿Ú¡±
                .TextMatrix(1, i) = Split(str´°¿Ú´®, ",")(i)
            End If
            
        Next
        
        '¾ÓÖÐÏÔÊ¾
        .ColAlignment(-1) = flexAlignCenterCenter
        
        'ºÏ²¢
        .MergeCells = flexMergeRestrictRows
        .MergeRow(0) = True
        
        '×ÖÌåÉèÖÃ
        .FontName = mPara.strÒÑ¹ýºÅ_×ÖÌå
        .FontSize = mPara.strÒÑ¹ýºÅ_×ÖºÅ
        .FontBold = mPara.blnÒÑ¹ýºÅ_´ÖÌå
        .FontItalic = mPara.blnÒÑ¹ýºÅ_Ð±Ìå
        .ForeColor = mPara.lngÒÑ¹ýºÅ_ÑÕÉ«
        
        'µ¥Ôª¸ñÉèÖÃ
        .ColWidth(-1) = mPara.lngÒÑ¹ýºÅ_ÁÐ¿í
        .RowHeight(-1) = mPara.lngÒÑ¹ýºÅ_ÐÐ¸ß
        
        .Width = mPara.lngÒÑ¹ýºÅ_ÁÐ¿í * .Cols
        .Height = mPara.lngÒÑ¹ýºÅ_ÐÐ¸ß * .Rows
        
    End With
    
    'Êý¾Ý³õÊ¼»¯
    Call LoadData_ÒÑ¹ýºÅ
    
End Sub

Private Sub RefreshList_Õýºô½Ð(ByVal rsData As ADODB.Recordset)
    '¹¦ÄÜ£ºË¢ÐÂ´ý·¢Ò©ÁÐ±í
    Dim i As Integer
    Dim n As Integer
    Dim int¹Ì¶¨ÁÐ As Integer       'Ä¬ÈÏµÚ¶þÐÐÎªÕýºô½ÐÐÅÏ¢
    
    int¹Ì¶¨ÁÐ = 2
    
    With vsf´ýÈ¡Ò©
        For i = 0 To .Cols - 1
            rsData.Filter = "·¢Ò©´°¿Ú = '" & .ColKey(i) & "'"
            
            'ÖØÐ´Êý¾Ý
            If Not rsData.EOF Then
                .TextMatrix(int¹Ì¶¨ÁÐ, i) = rsData!ÐÕÃû
            Else
                .TextMatrix(int¹Ì¶¨ÁÐ, i) = ""
            End If
        Next
    End With
End Sub

Private Sub RefreshList_´ý·¢Ò©(ByVal rsData As ADODB.Recordset)
    '¹¦ÄÜ£ºË¢ÐÂ´ý·¢Ò©ÁÐ±í
    Dim i As Integer
    Dim n As Integer
    Dim intÆð²½ÐÐ As Integer
    Dim intTemp As Integer
    
    intÆð²½ÐÐ = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, 0, 3)
    
    With vsf´ýÈ¡Ò©
        For i = 0 To .Cols - 1
            rsData.Filter = "·¢Ò©´°¿Ú = '" & .ColKey(i) & "'"
            
            'ÔÝÊ±Çå¿Õ¸ÃÁÐÊý¾Ý
            For n = intÆð²½ÐÐ + 1 To .Rows - 1
                .TextMatrix(n, i) = ""
            Next
            
            intTemp = IIf(rsData.RecordCount > mPara.lng´ý·¢Ò©_ÐÐÊý, mPara.lng´ý·¢Ò©_ÐÐÊý, rsData.RecordCount)
            
            'ÖØÐÂ¼ÓÔØ¸ÃÁÐÊý¾Ý
            For n = 1 To intTemp
                .TextMatrix(n + intÆð²½ÐÐ, i) = rsData!ÐÕÃû
                
                rsData.MoveNext
            Next
        Next
    End With
End Sub

Private Sub RefreshList_ÒÑ¹ýºÅ(ByVal rsData As ADODB.Recordset)
    '¹¦ÄÜ£ºË¢ÐÂÒÑ¹ýºÅÁÐ±í
    Dim i As Integer
    Dim n As Integer
    Dim intÆð²½ÐÐ As Integer
    Dim intTemp As Integer
    
    intÆð²½ÐÐ = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, 0, 1)
    
    With vsfÒÑ¹ýºÅ
        For i = 0 To .Cols - 1
            rsData.Filter = "·¢Ò©´°¿Ú = '" & .ColKey(i) & "'"
            
            'ÔÝÊ±Çå¿Õ¸ÃÁÐÊý¾Ý
            For n = intÆð²½ÐÐ + 1 To .Rows - 1
                .TextMatrix(n, i) = ""
            Next
            
            intTemp = IIf(rsData.RecordCount > mPara.lngÒÑ¹ýºÅ_ÐÐÊý, mPara.lngÒÑ¹ýºÅ_ÐÐÊý, rsData.RecordCount)
            
            'ÖØÐÂ¼ÓÔØ¸ÃÁÐÊý¾Ý
            For n = 1 To intTemp
                .TextMatrix(n + intÆð²½ÐÐ, i) = rsData!ÐÕÃû
                
                rsData.MoveNext
            Next
        Next
    End With
    
End Sub

Private Sub LoadData_Õýºô½Ð()
    '¹¦ÄÜ£º¼ÓÔØÕýºô½ÐÊý¾Ý
    'Èë²Î£º¡¾strWins¡¿´«ÈëµÄ·¢Ò©´°¿Ú
    Dim rsData As ADODB.Recordset
    Dim strSQL As String
    Dim date¿ªÊ¼ÈÕÆÚ As Date
    Dim date½áÊøÈÕÆÚ As Date
    Dim strWins As String
    
    On Error GoTo errHandle
    
    If mPara.blnµ¥´°¿ÚÄ£Ê½ Then Exit Sub
    
    strWins = mPara.str¶à´°¿Ú
    
    date¿ªÊ¼ÈÕÆÚ = gobjDatabase.Currentdate
    date¿ªÊ¼ÈÕÆÚ = CDate(Format(date¿ªÊ¼ÈÕÆÚ, "yyyy-mm-dd") & " 00:00:00")

    date½áÊøÈÕÆÚ = gobjDatabase.Currentdate
    date½áÊøÈÕÆÚ = CDate(Format(date½áÊøÈÕÆÚ, "yyyy-mm-dd") & " 23:59:59")
    
    strSQL = "Select ÐÕÃû,·¢Ò©´°¿Ú" & vbNewLine & _
            "From Î´·¢Ò©Æ·¼ÇÂ¼" & vbNewLine & _
            "Where ÅÅ¶Ó×´Ì¬ = 3 And ¿â·¿id = [1] And ·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) And ÌîÖÆÈÕÆÚ Between [3] And [4]"

    Set rsData = gobjDatabase.OpenSQLRecord(strSQL, "¼ÓÔØÕýºô½ÐÊý¾Ý", mlngÒ©·¿ID, strWins, date¿ªÊ¼ÈÕÆÚ, date½áÊøÈÕÆÚ)
    
    'Ë¢ÐÂÕýºô½Ð½çÃæÊý¾Ý
    Call RefreshList_Õýºô½Ð(rsData)
    
    Exit Sub
errHandle:
    If gobjComLib.ErrCenter() = 1 Then
        Resume
    End If
    Call gobjComLib.SaveErrLog
End Sub

Private Sub LoadData_´ý·¢Ò©()
    '¹¦ÄÜ£º¼ÓÔØ´ý·¢Ò©Êý¾Ý
    'Èë²Î£º¡¾strWins¡¿´«ÈëµÄ·¢Ò©´°¿Ú
    Dim rsData As ADODB.Recordset
    Dim strSQL As String
    Dim date¿ªÊ¼ÈÕÆÚ As Date
    Dim date½áÊøÈÕÆÚ As Date
    Dim strWins As String
    
    On Error GoTo errHandle
    
    strWins = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, mstrWins, mPara.str¶à´°¿Ú)
    
    date¿ªÊ¼ÈÕÆÚ = gobjDatabase.Currentdate
    date¿ªÊ¼ÈÕÆÚ = CDate(Format(date¿ªÊ¼ÈÕÆÚ, "yyyy-mm-dd") & " 00:00:00")

    date½áÊøÈÕÆÚ = gobjDatabase.Currentdate
    date½áÊøÈÕÆÚ = CDate(Format(date½áÊøÈÕÆÚ, "yyyy-mm-dd") & " 23:59:59")
    
    strSQL = "Select A.²¡ÈËID,A.ÐÕÃû,B.ÅäÒ©ÈÕÆÚ,B.Ç©µ½Ê±¼ä,B.ÌîÖÆÈÕÆÚ,A.·¢Ò©´°¿Ú " & _
            "From Î´·¢Ò©Æ·¼ÇÂ¼ A,Ò©Æ·ÊÕ·¢¼ÇÂ¼ B " & _
            "Where A.µ¥¾Ý=B.µ¥¾Ý And A.No=B.NO And A.¿â·¿id=B.¿â·¿id And (A.µ¥¾Ý=8 or A.µ¥¾Ý=9 or A.µ¥¾Ý=10) "

    If mblnÅäÒ© Then
        strSQL = strSQL & " and A.ÅÅ¶Ó×´Ì¬=2 and A.¿â·¿id=[1] and A.·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) and A.ÌîÖÆÈÕÆÚ between [3] and [4] And (B.¼ÇÂ¼×´Ì¬=1 Or Mod(B.¼ÇÂ¼×´Ì¬,3)=0)"
    ElseIf mblnÅäÒ©È·ÈÏ And mblnÅäÒ© = False Then
        strSQL = strSQL & " and (A.ÅÅ¶Ó×´Ì¬=1 or A.ÅÅ¶Ó×´Ì¬=2) and A.¿â·¿id=[1] and A.·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) and A.ÌîÖÆÈÕÆÚ between [3] and [4] And (B.¼ÇÂ¼×´Ì¬=1 Or Mod(B.¼ÇÂ¼×´Ì¬,3)=0)"
    ElseIf mblnÅäÒ© = False And mblnÅäÒ©È·ÈÏ = False Then
        strSQL = strSQL & " and (A.ÅÅ¶Ó×´Ì¬<3 or A.ÅÅ¶Ó×´Ì¬ is null) and A.¿â·¿id=[1] and A.·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) and A.ÌîÖÆÈÕÆÚ between [3] and [4] And (B.¼ÇÂ¼×´Ì¬=1 Or Mod(B.¼ÇÂ¼×´Ì¬,3)=0)"
    End If
    
    strSQL = "Select Rownum ÐòºÅ,ÐÕÃû,ÈÕÆÚ,·¢Ò©´°¿Ú " & _
            "From ( " & _
            "Select min(" & IIf(mblnÅäÒ©, "ÅäÒ©ÈÕÆÚ", "Nvl(Ç©µ½Ê±¼ä,ÌîÖÆÈÕÆÚ)") & ") ÈÕÆÚ,²¡ÈËid,ÐÕÃû,·¢Ò©´°¿Ú " & _
            "From (" & strSQL & ") " & _
            "Where ²¡ÈËID Not In (Select distinct A.²¡ÈËID From Î´·¢Ò©Æ·¼ÇÂ¼ A,Ò©Æ·ÊÕ·¢¼ÇÂ¼ B,ÃÅÕï·ÑÓÃ¼ÇÂ¼ C " & _
            "Where A.µ¥¾Ý=B.µ¥¾Ý And A.No=B.NO And A.¿â·¿id=B.¿â·¿id and B.·ÑÓÃid=C.id and (A.µ¥¾Ý=8 or A.µ¥¾Ý=9 or A.µ¥¾Ý=10) " & _
            "  and (A.ÅÅ¶Ó×´Ì¬=4 or A.ÅÅ¶Ó×´Ì¬ = 3) and A.¿â·¿id=[1] and A.·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) and A.ÌîÖÆÈÕÆÚ between [3] and [4] And (B.¼ÇÂ¼×´Ì¬=1 Or Mod(B.¼ÇÂ¼×´Ì¬,3)=0)) " & _
            "Group By ÐÕÃû,²¡ÈËid,·¢Ò©´°¿Ú " & _
            "Order by ÈÕÆÚ " & _
            ")"
                    
    Set rsData = gobjDatabase.OpenSQLRecord(strSQL, "¼ÓÔØ´ý·¢Ò©Êý¾Ý", mlngÒ©·¿ID, strWins, date¿ªÊ¼ÈÕÆÚ, date½áÊøÈÕÆÚ)
    
    'Ë¢ÐÂ´ý·¢Ò©½çÃæÊý¾Ý
    Call RefreshList_´ý·¢Ò©(rsData)
    
    Exit Sub
errHandle:
    If gobjComLib.ErrCenter() = 1 Then
        Resume
    End If
    Call gobjComLib.SaveErrLog
End Sub

Private Sub LoadData_ÒÑ¹ýºÅ()
    '¹¦ÄÜ£º¼ÓÔØÒÑ¹ýºÅÊý¾Ý
    'Èë²Î£º¡¾strWins¡¿´«ÈëµÄ·¢Ò©´°¿Ú
    Dim rsData As ADODB.Recordset
    Dim strSQL As String
    Dim strTemp As String
    Dim date¿ªÊ¼ÈÕÆÚ As Date
    Dim date½áÊøÈÕÆÚ As Date
    Dim strWins As String
    
    On Error GoTo errHandle
    
    strWins = IIf(mPara.blnµ¥´°¿ÚÄ£Ê½, mstrWins, mPara.str¶à´°¿Ú)
    
    date¿ªÊ¼ÈÕÆÚ = gobjDatabase.Currentdate
    date¿ªÊ¼ÈÕÆÚ = CDate(Format(date¿ªÊ¼ÈÕÆÚ, "yyyy-mm-dd") & " 00:00:00")

    date½áÊøÈÕÆÚ = gobjDatabase.Currentdate
    date½áÊøÈÕÆÚ = CDate(Format(date½áÊøÈÕÆÚ, "yyyy-mm-dd") & " 23:59:59")
    
    strSQL = "Select distinct A.²¡ÈËID,A.ÐÕÃû,A.ºô½ÐÊ±¼ä, A.·¢Ò©´°¿Ú From Î´·¢Ò©Æ·¼ÇÂ¼ A,Ò©Æ·ÊÕ·¢¼ÇÂ¼ B,ÃÅÕï·ÑÓÃ¼ÇÂ¼ C" & _
            " Where A.µ¥¾Ý=B.µ¥¾Ý And A.No=B.NO And A.¿â·¿id=B.¿â·¿id and B.·ÑÓÃid=C.id and (A.µ¥¾Ý=8 or A.µ¥¾Ý=9 or A.µ¥¾Ý=10) " & _
            "   and A.ÅÅ¶Ó×´Ì¬=4 and A.¿â·¿id=[1] and A.·¢Ò©´°¿Ú In (Select * From Table(Cast(f_Str2list([2]) As Zltools.t_Strlist))) and A.ÌîÖÆÈÕÆÚ between [3] and [4] And (B.¼ÇÂ¼×´Ì¬=1 Or Mod(B.¼ÇÂ¼×´Ì¬,3)=0) " & _
            " And a.ºô½ÐÊ±¼ä < Sysdate - 1 / 24 / 60 / 60 * [5] "
            
    strTemp = Replace(strSQL, "ÃÅÕï·ÑÓÃ¼ÇÂ¼", "×¡Ôº·ÑÓÃ¼ÇÂ¼")
            
    strSQL = strSQL & " union all " & strTemp
    
    strSQL = "Select rownum ÐòºÅ,ÐÕÃû,·¢Ò©´°¿Ú " & _
            "From (Select ²¡ÈËID,ÐÕÃû,min(ºô½ÐÊ±¼ä) ºô½ÐÊ±¼ä,·¢Ò©´°¿Ú " & _
            "From (" & strSQL & ") " & _
            "Group by ²¡ÈËID,ÐÕÃû,·¢Ò©´°¿Ú " & _
            "Order by ºô½ÐÊ±¼ä asc " & _
            ")"
    
    Set rsData = gobjDatabase.OpenSQLRecord(strSQL, "¼ÓÔØÒÑ¹ýºÅÊý¾Ý", mlngÒ©·¿ID, strWins, date¿ªÊ¼ÈÕÆÚ, date½áÊøÈÕÆÚ, 1)
    
    'Ë¢ÐÂÒÑ¹ýºÅ½çÃæÊý¾Ý
    Call RefreshList_ÒÑ¹ýºÅ(rsData)
    
    Exit Sub
errHandle:
    If gobjComLib.ErrCenter() = 1 Then
        Resume
    End If
    Call gobjComLib.SaveErrLog
End Sub

Private Sub DrawWallPaper()
    '¹¦ÄÜ£ºÉèÖÃ±í¸ñ¿Ø¼þµÄ±³¾°Í¼Æ¬Îª±í¸ñ±³ºóµÄÇøÓòÍ¼Æ¬
    Dim std As StdPicture
    Dim strTempFile As String
    
    On Error GoTo errHandle
    
    '´ý·¢Ò©±í¸ñ´¦Àí
    '--------------------------------
    picDraw.cls
    picDraw.Width = vsf´ýÈ¡Ò©.Width
    picDraw.Height = vsf´ýÈ¡Ò©.Height
    
    picDraw.PaintPicture img±³¾°.Picture, -vsf´ýÈ¡Ò©.Left, -vsf´ýÈ¡Ò©.Top, Me.ScaleWidth, Me.ScaleHeight
    
    Set vsf´ýÈ¡Ò©.WallPaper = picDraw.Image
    '--------------------------------
    
    'ÒÑ¹ýºÅ±í¸ñ´¦Àí
    '--------------------------------
    picDraw.cls
    picDraw.Width = vsfÒÑ¹ýºÅ.Width
    picDraw.Height = vsfÒÑ¹ýºÅ.Height
    
    picDraw.PaintPicture img±³¾°.Picture, -vsfÒÑ¹ýºÅ.Left, -vsfÒÑ¹ýºÅ.Top, Me.ScaleWidth, Me.ScaleHeight
    
    Set vsfÒÑ¹ýºÅ.WallPaper = picDraw.Image
    '--------------------------------

    Exit Sub
errHandle:
    If gobjComLib.ErrCenter() = 1 Then
        Resume
    End If
    Call gobjComLib.SaveErrLog
End Sub

Private Sub timData_Timer()
    '¹¦ÄÜ£º¶¨Ê±Ë¢ÐÂÏÔÊ¾ÆÁÊý¾Ý
    
    Call LoadData_Õýºô½Ð
    Call LoadData_´ý·¢Ò©
    Call LoadData_ÒÑ¹ýºÅ
    
    Call Changeºô½ÐÄÚÈÝ
End Sub

Private Sub timRest_Timer()
    mblnÕýÔÚÏÔÊ¾ = False
    
    Call Showºô½ÐÄÚÈÝ(False)
End Sub

Private Sub timTime_Timer()
    '¹¦ÄÜ£ºË¢ÐÂÊ±¼ä
    lblTime.Caption = Format(gobjDatabase.Currentdate, "yyyy-mm-dd  hh:mm")
End Sub
